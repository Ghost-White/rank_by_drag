<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>rank_by_drag</title>
</head>
<body>
	<div class="main">
		
	</div>

	<div class="upload_img">
		<p>
		    <label>请选择一个文件：</label>
		    <input type="file" id="file" />
		    <input type="button" value="读取图像" onclick = "readAsDataURL()"/>
		    <input type="button" value="读取二进制数据" onclick = "readAsBinaryString()"/>
		    <input type="button" value="读取文本文件" onclick = "readAsText()"/>
		    <input type="button" value="读取图像方法二" onclick = "readPicture()"/>
		</p>
		<div id="result"></div>
	</div>
</body>
<script type="text/javascript" src="js/main.js"></script>
<script type="text/javascript">
    var result = document.getElementById("result");
    if(typeof FileReader == 'undefined') {
        result.innerHTML = "抱歉，你的浏览器不支持FileReader";
    }
    // 将文件以Data URL形式进行读入页面
    function readAsDataURL(){
        // 检查是否为图像类型
        var simpleFile = document.getElementById("file").files[0];
        if(!/image\/\w+/.test(simpleFile.type)) {
            alert("请确保文件类型为图像类型");
            return false;
        }
        var reader = new FileReader();
        // 将文件以Data URL形式进行读入页面,包含数据类型、编码方式、编码数据三部分
        reader.readAsDataURL(simpleFile);
        reader.onload = function(e){
        	var data = this.result;
            data = data.replace("data:image/jpeg;base64,","");
            console.log(window.atob(data));		
            result.innerHTML = '<img src="'+this.result+'" alt=""/>';
        }
    }
    // 将文件以二进制形式读入页面
    function readAsBinaryString(){
        // 检查是否为图像类型
        var simpleFile = document.getElementById("file").files[0];
        if(!/image\/\w+/.test(simpleFile.type)) {
            alert("请确保文件类型为图像类型");
            return false;
        }
        var reader = new FileReader();
        // 将文件以二进制形式进行读入页面
        reader.readAsBinaryString(simpleFile);
        reader.onload = function(e){
            // 在页面上显示二进制数据
            result.innerHTML = this.result;
        }
    }
    // 将文件以文本形式读入页面中
    function readAsText(){
        var simpleFile = document.getElementById("file").files[0];
        var reader = new FileReader();
        // 将文件以文本形式读入页面中
        reader.readAsText(simpleFile);
        reader.onload = function(e){
            result.innerHTML = this.result;
        }
    }

    function readPicture(){
	    // 检查是否为图像类型
	    var simpleFile = document.getElementById("file").files[0];
	    if(!/image\/\w+/.test(simpleFile.type)) {
	        alert("请确保文件类型为图像类型");
	        return false;
	    }
	    var reader = new FileReader();
	    // 将文件以二进制文件读入页面中
	    reader.readAsBinaryString(simpleFile);
	    reader.onload = function(f){
	        var src = "data:" + simpleFile.type + ";base64," + window.btoa(this.result);
	        result.innerHTML = '<img src ="'+src+'"/>';
	    }
	}
</script>
</html>